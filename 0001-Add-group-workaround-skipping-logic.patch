From 159e4aed9789c82d634a061b2bea573845601042 Mon Sep 17 00:00:00 2001
From: Scott K Logan <logans@cottsay.net>
Date: Wed, 3 Apr 2024 15:46:38 -0500
Subject: [PATCH] Add group workaround skipping logic

---
 package.xml | 23 +++++++++--------------
 1 file changed, 9 insertions(+), 14 deletions(-)

diff --git a/package.xml b/package.xml
index abb5da00e5e2..a1fd9b2c9122 100644
--- a/package.xml
+++ b/package.xml
@@ -17,20 +17,15 @@
   <buildtool_export_depend>ament_cmake_core</buildtool_export_depend>
   <buildtool_export_depend>rosidl_cmake</buildtool_export_depend>
 
-  <!-- Bloom does not support group_depend, so this unrolls rosidl_generator_packages -->
-  <buildtool_export_depend>rosidl_generator_c</buildtool_export_depend>
-  <buildtool_export_depend>rosidl_generator_cpp</buildtool_export_depend>
-  <buildtool_export_depend>rosidl_generator_py</buildtool_export_depend>
-
-  <!-- Bloom does not support group_depend, so this unrolls rosidl_typesupport_c_packages -->
-  <buildtool_export_depend>rosidl_typesupport_c</buildtool_export_depend>
-  <buildtool_export_depend>rosidl_typesupport_fastrtps_c</buildtool_export_depend>
-  <buildtool_export_depend>rosidl_typesupport_introspection_c</buildtool_export_depend>
-
-  <!-- Bloom does not support group_depend, so this unrolls rosidl_typesupport_cpp_packages -->
-  <buildtool_export_depend>rosidl_typesupport_cpp</buildtool_export_depend>
-  <buildtool_export_depend>rosidl_typesupport_fastrtps_cpp</buildtool_export_depend>
-  <buildtool_export_depend>rosidl_typesupport_introspection_cpp</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_generator_c</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_generator_cpp</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_generator_py</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_typesupport_c</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_typesupport_fastrtps_c</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_typesupport_introspection_c</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_typesupport_cpp</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_typesupport_fastrtps_cpp</buildtool_export_depend>
+  <buildtool_export_depend condition="$DISABLE_GROUP_WORKAROUND != 1">rosidl_typesupport_introspection_cpp</buildtool_export_depend>
 
   <test_depend>ament_lint_auto</test_depend>
   <test_depend>ament_lint_common</test_depend>
-- 
2.44.0

